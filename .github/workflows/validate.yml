name: Lint and validate

on:
  workflow_call:

jobs:
  validate:

    runs-on: ubuntu-latest

    steps:

    - name: Code checkout
      uses: actions/checkout@v3

    - name: Lint Dockerfile
      uses: hadolint/hadolint-action@v3.1.0
      with:
        dockerfile: Dockerfile
        failure-threshold: error

    - name: Check all shell scripts
      uses: ludeeus/action-shellcheck@master
      with:
        severity: error
        check_together: 'yes'
        format: gcc

    - name: Check all php files
      uses: firehed/lint-php-action@v1
      with:
        php-version: '7.4'